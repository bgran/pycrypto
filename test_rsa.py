import unittest

import rsa, gen_rsa

class TestRSA(unittest.TestCase):
    def test_prime(self):
        print ("====> test_prime")
        prime = rsa.Prime(rsa.RSA_bits, rsa.RM_iterations)
        num, is_prime = prime.gen_prime()
        self.assertTrue(is_prime)
    def test_enc_dec_low(self):
        #p1 = rsa.Prime(1024, 200)
        #p,_ = p1.gen_prime()
        #p2 = rsa.Prime(1024, 200)
        #q,_ = p2.gen_prime()
        print("====> test_enc_dec_low")
        self.assertTrue(gen_rsa.crypto_test())

    #def test_enc_dec_high(self):
    #    p1 = rsa.Prime(2048, 1000)
    #    p,_ = p1.gen_prime()
    #    p2 = rsa.Prime(2048, 1000)
    #    q,_ = p2.gen_prime()
    #    if gen_rsa.test(p, q):
    #        return True
    #    else:
    #        return False

    def test_primegen(self):
        print("====> test_primegen")
        primes = rsa.Prime_Gen(10000).gen()
        #print ("primes: {}".format(len(primes)))
        self.assertTrue(len(primes) == 1229)

    def _test_rabinmiller(self):
        print("====> test_rabinmiller")
        ##primes = rsa.Prime_Gen(10000).gen()
        ##prime = rsa.Prime(rsa.RSA_bits, rsa.RM_iterations)
        ##p = prime.gen_prime()

    def test_large_encryption(self):
        print ("====> test_large_encryption")
        p = 572747359640684732444493668001139322912621628820980316606190395715012516357502628890276048215611707164158122351217007036997467410043766884517980681052515429173307215115803303378858932124397846242267708783568150569278971050924545789842296702119145515767859178323712936734138526328822080229065413301737957574736105404956392795643892410683981487031525919558278530560905490054921037386582087668518824038505054835844727154766992872965189275041943581402292717668403789201298112980236108369653624481893478501661244476634887039394401025387333752631180009785776624071538073012341566228231456153643262043479011014371267617797243971827077116293588952328286299496478987390190357086668214260836612629035557272898991219075002551086296518348085368666574738839814705714985954167910756699675230449283823411122413704573123858361098936913917389760964530763256870366042002060707055843036307663794068598392360820387620829923947775274634464228726303007147771382682951510769295424465750803480877345480555653565333818937194675527276151281129664240851383485876879394168799142399688368955114901855880195266057646504145526683511690269676426088547670086509771876302105039354801070984677126453187750268369846930817836809980267248683034583465591826713184240367003037551341515548113846195886981993288328818906347329675680939672779175431515372979087037052602852491687882071383226745082643777827256052714176930556202631274643038364739806418086520511842926026657544469981814567198673922592017929049137335564996890247501998604303907378919193826543908052630420522702758751528351919880777908940338589418232376389577896472168041209726141311676423004377836233637858246205080568312085458399112357918594379967065468419029441155371224402055121230516378093523888518661895492945961252396783645011105603240995295225137906281260146250970722375838224962101383919565354634538654293485336945501462352958280568798516444513934590565568394581587463283549950891434444693856974240691854388782675848774334422522702284757734168213153970674048928063752957468961451876762727839559228163785604967931755955899498911615739976701685368174840130355529245251019479704685716780768897871849075979220167537173238347047418808531845211648952187958718229298308761704750017536236954143877934747316823208266353280057759673394281216289952341148127499743751306865112368814462944970119542889246072760283713488679607752929815537100525982650974954009904541860715720352881268123994264936279754624387165653818871715487121061156689462210530764410034223196100345036270536075985015745051968302449637326207467062605465104906257173316432833230867545435881879447649197293054219576681879544019705457726814868111556675567506507323774402257755432221643126125709874266369356946970547547907045225002097810160568630762486157911430481881190928813444842407783925818154898013695085313372301861000789996187922391122174192379981595502627084243243893120596212787694198379302079160344125726508744219877762357095681792890222692991865104749232977671540114870612646974764081793615296380073626360868490321023069151031991514431476881394509392050079390538094912358320845007308607137562066315018356580776663411334593483934327117097089506196414137019793547024496570123004769438323507929834809543698797673366270433146421308439150833805988833485952790469907851271607166399701650132875044130448412838224270257897585531678653283320976737693473921887156516862190287146647219186877688740956334345718024620778128572554979908211769678791353681815141050667732806858651320375013824107231873657962110745509204265446826287658586838359484491601295020114894481938707235552911623637194384451392680150859065245019391255165358321216284080424248078772060640238202619003834786366909930324312000468936805750418377336160579311054761809584359631892223112768361893676447697249269548536685712552783434246205185334845353496826935198533203907915937368968549452608850925195862894677858729175233918964651458874544814887715871899559356947403480862257091157652766827692668382512011567107818506537490638324307200113752373469649685338775045701721417103048105058079352357364657087633855127244661415466108681658346606593298862866937707749461091833839677596454685676352562926291941088555054987517538866944443141777360154382273861277002961226487315330825664277160725371089692809263788447162713594498362867440223116825057792707245871431273860357060338632334980968717419647935267203671150961439929900260789190792461643700148314411748785098277579832872831490529094736957360786209278428117881309537776701909160610965017143338064751209406409946633780122513459555518191884246718897372464324886329308644812213549548818640226450004952802821501524842620005352123280132423146929442899267533500436534556729414620707693916471979177239991485942717435037260943971025416717788448039235057891835150283625742290592656689391257775450026705727809340779674502202395713186770622949425405783756226061583847992546730237419690491950265945839425180254391473685546348450746598408195629161578389578229
        q = 392045297267161004587383128533176579928085882180106669003408859069235859660335434139414565570285055989541136478051596905309314872484420679922441555817750322539965420581844095766064384258136508393474751513176888315571109185439636454066990914164221846025026363732374198599831016626348744345308241023394387155456797052022210645605113013457251294480510781781828472974011253218848862704503273235617968405136853626809991935978074812224943199843693996276991957355652054052163837520072578801181538658822787952433201792491290123798924863280366339555948029565269489920622876655243909370032384775882961827316793709701181956539720261740034333506431493912503102680461604504879363147367564161920294291519930123673347768870559397044629347214707482268523502103764970880747658807326501541273900091398136099501598412381282108869103600304866180167518205971262518931223029644058510265279010621562740314183612308205376952005282813568849829781526582697061677912912660107665887776272118256337927247338038568917891603817563616064742669127870415712615535941770414620928784431193903237839149730256697689226125617636188722118106649829939286636295904908742140079448057882118679656019972010100882541777896437952985664346785705847220592675467349487122924628647590241911477270548949899230339403747082434398704696202886581361366219065701046759894992795421053827029739046829600533139993917712364527102957587218839645147263073538401289261168969730292591543535120356591178094028083433088936910274046734023870782488863156769621508684344173627487752071688150482840757594211675075802974744726459482457652504562924034727752407925481093130881024498711409605386322367178230511277993173304073639209977281666585186883980103870531949808382132142013989580824058213624391542092408831421257248412979711246605674469795624530253942541649883683509763046622405310083433010525592700422416415291032387187256304117886473194426776278960614736956694719529220513990897130699906428112127355896929436765296832338532169778653753163689659003313184572788607890350511948350958774493326168142072891892794655645619251316887461301821216074172922323354786438740231517954258756538361199333831732320218932452143838271617883922361232191486022619159127624039110181370354586999966379846623584429627464127856847525665545485869309552291791726109215091192207831248998967740518363118660158631082534167339864929015216877605956531212789861922466685337915893425066155476343475113050281253563806753534883703766538037679234357375867474432190539705723935327091904376921260102051087463414933995617599524569023951352425441751345297881167113352375676746052901162718650738198062932907387408295290722660724277679182139427188342126479634585997935431459023573855761902553753044677477334968415693962434799545427557962504930156731185418617349275118765000081386717588315815383229179384697002897716517050213832796193869870188992842761376643616937569549123162748945340506152324675723422616310037510677128876717199761950214023408615732388023811029055580122210300599508805793288171112002307669679177721568489547853898487349704970119204885682046053956750507025177133141709772246678805071995099427625314405157075555366176899720969333191748715528840006089382937228017102355334315291950797917361707537149494107342728146099835105144605333600030311623294578218618341189146431800427459952032546429404327500332301347570394419056943291673220731467390942911358443969857625509954435246757877588917286694533751634561717147009258776381026268149559427417223569069380664142570190116622950245188856008566796992142428202719442812151313503453007516780249998866975140093131384936500127731203144111689908179520244363218193670139673238787731878804817362327076778269508186755288363972673227808363034799336492287084993040162320827305389616826966350444645128777911446446155422388467374728276313514426990546679888098925078776776753144345163472500991819901598090053628500819393534657420497296351238697751605374068663339347056003431260211113288528148979251280489684819534009583716200186168062428713061052953843138371355179383712207265223582708076082944084442062566518876414320461432199200401388841375048470040163523171230980325904009267734432794876373827428378080050573805676232913207852320897307738853078034647345968791586258797612820761577451858197772845270581569007199521969464710248435760079238121415729268906337342957855601539780205984302368845088946209561556361762406946041173415165642447605038709662463171804164940266909278932349500502906024857174662772244318577252117466923591545901502347972555147658028516765543571998374788568283331443079607589004889584669132316013894996797410672882774977582898652929083622900300131117779513207129136281122760468559464108644757944247334218662899982877649735753560915518647808830019952709357867457792363302884989518098528162153277893176098723006990329047771233196688520442239978396875328214608177194508440502383426808083102803407541085877296610969125696923744239314977066491753159683455866076591832083159933295649
        cleartext = "Terve maailma"
        cipher = rsa.encrypt((p,q), cleartext)
    
        p2 = 196106192387437755263140487862285717518532159939941346113678749728804165833360020855957223600524617953452019534657033678654303292625867830954607984065070132269137122267136921211861038316563020289245573704689807793881207937509006538993275456248783327037626162738982646494054989613761554594174750122177109586442824930887690249873570008641790638032746418377812515495873483538508554726480720332704999791070602140524448328691665802249055250912221196620837824786127917588951316334052592491992754990934298168692786139353273446630824264508351203375920327462670412222458497298148631391994039836290584949799343568878674515710976980415021020643368841417426539607731034138504815334331304784899536030810651382925111555779892843051422803134277194586371809078850339209449292545261518105485078626833844872713140004044534956160772755821421464393878489041648001242503282251665900908537815607417587673696956973193085313613619982551885979475682131676892206945447627431483367131001908303653582652807050190741650929977338107523484926202256786177615209845329040446038313756191322307555376822475076702173004776970041027030835084459289371924801282321471965498314364387496402115391929156655211545437298149288889731595232696801869451903569237112964680168446085388628682184069571026331071336757987050428416079892550120910693410548880802608132778671069136625203024075248023007589347339309115479096478932002569902896700952972721030367051426573246863075578250897440641987980063456859675236130829192865229152275636312656250467029438529308460099492030659991989078513670911716354896435660450973886306870039389479208012011995542524261214035352134980596860501156237570410412447409325832682640822502119926376623222293981050750382735797926748531075989395182046373453102248774947861419303270884603072588117740499259306185684338297542990297163236040285837693193561703777925062813244081727956144497874728271713880507433542229627065442143009435297172783229457428045595022847630753036816352047759614969231503002468891369973169742143909376366678673113942284182804360658013136891950595496551481235022071455834441579288474082724407582528251908502406515514655578492519031169885610453589933317609306440940202638985969321203926677842566494223900294218655482488873543236422900022126306402351991080011772294439800594724937334015690076479116440159438495919199432836568508465146762220395825032087245906138726885318492637242911690151160925911964631589634761752598831889715549804657611797897489296942757298904997605987792019668396188505489112844480458715769768379371958648894481577380044068958499765274364460579909133861723945966986658801141286383994579466775061987815495540211718564899592130936589802648240241118027355150522415082899149432575382776837442089175215207021949011012223073770235365299271271504968788746397025523540318321002049054209440957095645399399783037190612078542189064818289355219931362902189468078989299447488835442776570226913167349717812062467242660953996012330970996145279197590097977104789659992682030365625041503385616338419498985000227603157733417873901398727715317551592119413176830037392521795059583129801206121217282980689103937446331415124572074536396095565399755676593919479672599274790873150947101949021089898091004366761036589091042541503983263650939935460144039062840916794714000549562163825766154010487970215361063662125847378117785542476220484433955432032138929882713561737992909353604582706624145082362543144810039833283596954027682717593690247434209556415723320762594705970183760496591811587355857982453115286090038480045970159781215988687572323412949421435148757717649836566114008541600075458323180003721084226609855877442217351359625360341019290327023875904682357881094634264577873335545928839958553588441564461365760538026820298421199721308030692362390360862274131798083960273072349862577908013329040987681884857956080091708653758677845707758530946819348317385651791470286356658477159385499783082410227837771180188154516711854321571082382549675589666861405045926979433964935104573251258784748801225274162875764638809710482354141401987840723382202971250187778742705141926220334802510227827083330958040156726003269655321988578898507944136050932696703830538030140533001151437524793844170530771888130145980531397369015504830530802918560617824815120286525966259745258255882149856919419479838711541705746280929223442874381455750229740164779020078731494603301704870191848343440214686066491667591907222024376388159894792439087347556862922270736368816731427967087185073679884306909306839789064460537487703763374061802465203032194218944288892669875208349927255209922268643413628653846338624968121581066828936789765600420408179884958206049719299031615481787936801779872433200900846337788350219518392230308272801551698695067723894697409659398307324213124589378465404117989385951228993468128105053921544220215118276160338633296043206930844373867816579528589461904996042695517832677853250973282414921504701877869252076038831442461056618354640128893028250791469
        q2 = 392045297267161004587383128533176579928085882180106669003408859069235859660335434139414565570285055989541136478051596905309314872484420679922441555817750322539965420581844095766064384258136508393474751513176888315571109185439636454066990914164221846025026363732374198599831016626348744345308241023394387155456797052022210645605113013457251294480510781781828472974011253218848862704503273235617968405136853626809991935978074812224943199843693996276991957355652054052163837520072578801181538658822787952433201792491290123798924863280366339555948029565269489920622876655243909370032384775882961827316793709701181956539720261740034333506431493912503102680461604504879363147367564161920294291519930123673347768870559397044629347214707482268523502103764970880747658807326501541273900091398136099501598412381282108869103600304866180167518205971262518931223029644058510265279010621562740314183612308205376952005282813568849829781526582697061677912912660107665887776272118256337927247338038568917891603817563616064742669127870415712615535941770414620928784431193903237839149730256697689226125617636188722118106649829939286636295904908742140079448057882118679656019972010100882541777896437952985664346785705847220592675467349487122924628647590241911477270548949899230339403747082434398704696202886581361366219065701046759894992795421053827029739046829600533139993917712364527102957587218839645147263073538401289261168969730292591543535120356591178094028083433088936910274046734023870782488863156769621508684344173627487752071688150482840757594211675075802974744726459482457652504562924034727752407925481093130881024498711409605386322367178230511277993173304073639209977281666585186883980103870531949808382132142013989580824058213624391542092408831421257248412979711246605674469795624530253942541649883683509763046622405310083433010525592700422416415291032387187256304117886473194426776278960614736956694719529220513990897130699906428112127355896929436765296832338532169778653753163689659003313184572788607890350511948350958774493326168142072891892794655645619251316887461301821216074172922323354786438740231517954258756538361199333831732320218932452143838271617883922361232191486022619159127624039110181370354586999966379846623584429627464127856847525665545485869309552291791726109215091192207831248998967740518363118660158631082534167339864929015216877605956531212789861922466685337915893425066155476343475113050281253563806753534883703766538037679234357375867474432190539705723935327091904376921260102051087463414933995617599524569023951352425441751345297881167113352375676746052901162718650738198062932907387408295290722660724277679182139427188342126479634585997935431459023573855761902553753044677477334968415693962434799545427557962504930156731185418617349275118765000081386717588315815383229179384697002897716517050213832796193869870188992842761376643616937569549123162748945340506152324675723422616310037510677128876717199761950214023408615732388023811029055580122210300599508805793288171112002307669679177721568489547853898487349704970119204885682046053956750507025177133141709772246678805071995099427625314405157075555366176899720969333191748715528840006089382937228017102355334315291950797917361707537149494107342728146099835105144605333600030311623294578218618341189146431800427459952032546429404327500332301347570394419056943291673220731467390942911358443969857625509954435246757877588917286694533751634561717147009258776381026268149559427417223569069380664142570190116622950245188856008566796992142428202719442812151313503453007516780249998866975140093131384936500127731203144111689908179520244363218193670139673238787731878804817362327076778269508186755288363972673227808363034799336492287084993040162320827305389616826966350444645128777911446446155422388467374728276313514426990546679888098925078776776753144345163472500991819901598090053628500819393534657420497296351238697751605374068663339347056003431260211113288528148979251280489684819534009583716200186168062428713061052953843138371355179383712207265223582708076082944084442062566518876414320461432199200401388841375048470040163523171230980325904009267734432794876373827428378080050573805676232913207852320897307738853078034647345968791586258797612820761577451858197772845270581569007199521969464710248435760079238121415729268906337342957855601539780205984302368845088946209561556361762406946041173415165642447605038709662463171804164940266909278932349500502906024857174662772244318577252117466923591545901502347972555147658028516765543571998374788568283331443079607589004889584669132316013894996797410672882774977582898652929083622900300131117779513207129136281122760468559464108644757944247334218662899982877649735753560915518647808830019952709357867457792363302884989518098528162153277893176098723006990329047771233196688520442239978396875328214608177194508440502383426808083102803407541085877296610969125696923744239314977066491753159683455866076591832083159933295649
        r = rsa.decrypt((p2, q2), cipher)
        #assert cleartext == r
        self.assertTrue(cleartext == r)

if __name__ == "__main__":
    unittest.main()

